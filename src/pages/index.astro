---
import Layout from "../layouts/Layout.astro";

// Capability Tabs data
const tabs = [
  {
    id: "pmm",
    label: "Product Marketing",
    accent: "#3D7B6E",
    metrics: [
      {
        highlight: "164%",
        description: "Increase in USD Portfolio net deposits post-launch",
        detail: "Launched the USD Portfolio product with a full GTM strategy, aligning product positioning with customer education campaigns that drove a 164% surge in net deposits within the first quarter.",
      },
      {
        highlight: "35% MoM",
        description: "Growth in acquisition via Homepage Revamp",
        detail: "Redesigned the homepage acquisition funnel with data-driven messaging and A/B tested layouts, resulting in 35% month-over-month growth in new user sign-ups.",
      },
      {
        highlight: ">5%",
        description: "Revenue growth in Juice Category via PMF analysis",
        detail: "Conducted a deep Product-Market Fit analysis for the Juice category, identifying underserved segments and repositioning the value proposition to unlock over 5% incremental revenue growth.",
      },
    ],
    cta: "View GTM Case Studies",
  },
  {
    id: "growth",
    label: "Growth & Lifecycle",
    accent: "#5A6E8A",
    metrics: [
      {
        highlight: "2x",
        description: "Retention Rate doubled (15% to 31%) via education focus",
        detail: "Built a behavioral education framework that doubled user retention from 15% to 31%, turning first-time depositors into long-term investors through targeted lifecycle campaigns.",
      },
      {
        highlight: "17%",
        description: "Improvement in Marketing Efficiency via data-pulse reviews",
        detail: "Implemented weekly data-pulse reviews across all paid and organic channels, systematically reallocating budget to high-performing segments and improving overall marketing efficiency by 17%.",
      },
      {
        highlight: "200%",
        description: "MoM growth for Shopee Store via dynamic bundling",
        detail: "Developed a dynamic bundling strategy for the Shopee store, using real-time sales data to optimize product combinations and drive 200% month-over-month revenue growth.",
      },
    ],
    cta: "View Retention Framework",
  },
  {
    id: "commercial",
    label: "Commercial Strategy",
    accent: "#8A6A7E",
    metrics: [
      {
        highlight: "37%",
        description: "Market reach expansion via Touch 'n Go integration",
        detail: "Negotiated and executed a strategic integration with Touch 'n Go's Super App ecosystem, expanding market reach by 37% through embedded financial services.",
      },
      {
        highlight: "300%",
        description: "MoM sales increase via bank partnership",
        detail: "Structured a co-marketing partnership with a major bank, creating exclusive product bundles that drove a 300% month-over-month increase in sales volume.",
      },
      {
        highlight: "6 Months",
        description: "Time to unit profitability for US Treasury product",
        detail: "Managed the full P&L for the US Treasury product launch, optimizing acquisition costs and pricing strategy to achieve unit profitability within just 6 months.",
      },
    ],
    cta: "View Commercial Wins",
  },
];
---

<Layout title="Vian | Growth Marketer">
  <!-- Masthead Navigation -->
  <header
    class="w-full border-b border-[#E5E2DC] px-6 py-5 md:px-16 flex items-center justify-between"
  >
    <div class="flex items-center gap-8">
      <!-- Logo -->
      <span class="font-display font-bold text-2xl text-[#1A1A1A] tracking-logo">
        VIAN
      </span>

      <!-- Navigation -->
      <nav class="hidden md:flex items-center gap-6">
        <a
          href="#"
          class="text-xs font-semibold text-[#1A1A1A] tracking-nav flex items-center gap-2"
        >
          <span class="w-1.5 h-1.5 rounded-full bg-[#1A1A1A]"></span>
          Overview
        </a>
        <a href="#capabilities" class="text-xs text-[#999999] tracking-nav hover:text-[#1A1A1A] transition-colors">
          Capabilities
        </a>
        <a href="#" class="text-xs text-[#999999] tracking-nav hover:text-[#1A1A1A] transition-colors">
          About
        </a>
      </nav>
    </div>

    <div class="flex items-center gap-4">
      <!-- Resume Button -->
      <a
        href="/resume.pdf"
        download
        class="hidden md:flex items-center gap-2 bg-[#1A1A1A] text-white text-[11px] font-semibold tracking-section px-4 py-2"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="14"
          height="14"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="7 10 12 15 17 10"></polyline>
          <line x1="12" y1="15" x2="12" y2="3"></line>
        </svg>
        RESUME
      </a>

      <!-- Avatar -->
      <div
        class="w-8 h-8 bg-[#E8E5DF] flex items-center justify-center text-[10px] font-semibold text-[#666666]"
      >
        VN
      </div>
    </div>
  </header>

  <main class="w-full max-w-[1440px] mx-auto flex flex-col">
    <!-- Topfold -->
    <section class="flex flex-col items-center gap-8 px-6 py-16 md:px-20 md:py-16">
      <!-- Photo -->
      <div
        class="w-36 h-36 md:w-40 md:h-40 bg-[#F5F2ED] border border-[#E5E2DC] flex flex-col items-center justify-center gap-2 overflow-hidden flex-shrink-0"
      >
        <!-- Replace with: <img src="/images/vian-photo.jpg" alt="Vian" class="w-full h-full object-cover" /> -->
        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#999999" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        <span class="text-[10px] text-[#999999]">Your photo</span>
      </div>

      <!-- Headline -->
      <h1 class="font-display text-4xl md:text-5xl font-normal text-[#1A1A1A] tracking-[-1px] text-center">
        Hi, I'm Vian
      </h1>

      <!-- Subtitle -->
      <p class="text-sm font-medium text-[#999999] tracking-[1px] text-center">
        Growth Strategist · SE Asia
      </p>

      <!-- Logo Bar (Pill) -->
      <div class="flex flex-col items-center gap-3 border border-[#E5E2DC] rounded-full px-8 md:px-10 py-5">
        <span class="text-[13px] text-[#666666]">Shipped results for</span>
        <div class="flex items-center gap-5 md:gap-6">
          <span class="text-base font-bold text-[#1A1A1A]">Shopee</span>
          <span class="text-base text-[#E5E2DC]">&middot;</span>
          <span class="text-base font-bold text-[#1A1A1A]">StashAway</span>
          <span class="text-base text-[#E5E2DC]">&middot;</span>
          <span class="text-base font-bold text-[#1A1A1A]">Carsome</span>
        </div>
      </div>

      <!-- About -->
      <h2 class="text-[13px] font-medium text-[#1A1A1A] text-center">About</h2>
      <p class="text-[15px] text-[#666666] leading-[1.7] text-center max-w-xl">
        Your bio goes here. Write 2–3 sentences about what you do, who you've
        done it for, and why you're different. Keep it conversational and
        confident — let the work below speak for the rest.
      </p>

      <!-- Scroll CTA -->
      <a href="#capabilities" class="text-xs font-medium text-[#999999] tracking-[0.5px] hover:text-[#666666] transition-colors">
        ↓&ensp;See case studies
      </a>
    </section>

    <!-- Capability Tabs Section -->
    <section id="capabilities" class="flex flex-col gap-8 px-6 py-12 md:px-20">
      <!-- Section Divider -->
      <div class="flex items-center justify-between border-t border-[#E5E2DC] pt-4">
        <span class="text-[10px] font-bold text-[#1A1A1A] tracking-[2px] uppercase">
          Capabilities
        </span>
      </div>

      <!-- Tab Navigation -->
      <div class="flex items-center border-b border-[#E5E2DC]">
        {
          tabs.map((tab, i) => (
            <button
              data-tab={tab.id}
              class={`tab-btn px-4 py-3 text-[12px] tracking-[0.5px] border-b-2 transition-all cursor-pointer ${
                i === 0
                  ? "font-semibold text-[#1A1A1A] border-[#1A1A1A]"
                  : "font-medium text-[#999999] border-transparent hover:text-[#666666]"
              }`}
            >
              {tab.label}
            </button>
          ))
        }
      </div>

      <!-- Tab Content Panels -->
      {
        tabs.map((tab, i) => (
          <div
            data-panel={tab.id}
            class={`tab-panel ${i === 0 ? "" : "hidden"}`}
          >
            <div class="grid grid-cols-1 md:grid-cols-2">
              {/* Metrics Column */}
              <div class="flex flex-col md:pr-8">
                {tab.metrics.map((metric, j) => (
                  <div
                    class={`metric-row relative flex items-center gap-4 py-5 border-b border-[#E5E2DC] cursor-pointer transition-opacity duration-300 ${j === 0 ? "" : "opacity-[0.35]"}`}
                    data-metric-idx={String(j)}
                  >
                    <div class="flex-1">
                      <span
                        class="font-mono text-3xl font-semibold tracking-[-1px]"
                        style={`color: ${tab.accent}`}
                      >
                        {metric.highlight}
                      </span>
                      <p class="text-[13px] text-[#666666] leading-[1.5] mt-1">
                        {metric.description}
                      </p>
                    </div>
                    <a
                      href="#"
                      class="metric-chevron w-10 h-10 rounded-full border border-[#E5E2DC] flex items-center justify-center flex-shrink-0 hover:border-[#999999] transition-colors"
                      aria-label="View case study"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#999999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="9 18 15 12 9 6"></polyline>
                      </svg>
                    </a>
                    {/* Progress bar overlays border-bottom */}
                    <div class="absolute bottom-0 left-0 right-0 h-[2px]">
                      <div
                        class="metric-progress-bar h-full w-0"
                        style={`background-color: ${tab.accent}`}
                      ></div>
                    </div>
                  </div>
                ))}
              </div>

              {/* Detail Column (desktop only) */}
              <div class="hidden md:flex md:border-l md:border-[#E5E2DC] md:pl-8">
                <div class="grid flex-1 items-center">
                  {tab.metrics.map((metric, j) => (
                    <div
                      class={`metric-detail col-start-1 row-start-1 flex flex-col gap-6 justify-center transition-opacity duration-300 ${j === 0 ? "opacity-100" : "opacity-0 pointer-events-none"}`}
                      data-detail-idx={String(j)}
                    >
                      <p class="text-[15px] text-[#666666] leading-[1.7]">
                        {metric.detail}
                      </p>
                      <a
                        href="#"
                        class="inline-flex items-center gap-2 text-[12px] font-semibold tracking-[0.5px] hover:opacity-70 transition-opacity w-fit"
                        style={`color: ${tab.accent}`}
                      >
                        {tab.cta}
                        <span>→</span>
                      </a>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </div>
        ))
      }
    </section>
  </main>

  <!-- Footer -->
  <footer class="w-full border-t border-[#E5E2DC] px-6 py-8 md:px-16">
    <div class="max-w-[1440px] mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
      <span class="text-xs text-[#999999]">
        © 2026 Vian. Growth Marketer.
      </span>
      <span class="text-xs text-[#999999]">
        Singapore
      </span>
    </div>
  </footer>
  <script>
    const ROTATION_MS = 7000;
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabPanels = document.querySelectorAll('.tab-panel');

    let currentTab = 'pmm';
    const activeIdx = {};
    const timers = {};

    // Initialize metric index for each tab
    tabPanels.forEach((panel) => {
      activeIdx[panel.getAttribute('data-panel')] = 0;
    });

    function activateMetric(tabId, index) {
      const panel = document.querySelector(`[data-panel="${tabId}"]`);
      if (!panel) return;

      activeIdx[tabId] = index;

      // Dim/highlight metric rows
      panel.querySelectorAll('.metric-row').forEach((row, i) => {
        row.style.opacity = i === index ? '1' : '0.35';
      });

      // Fade detail panels
      panel.querySelectorAll('.metric-detail').forEach((detail, i) => {
        if (i === index) {
          detail.classList.remove('opacity-0', 'pointer-events-none');
          detail.classList.add('opacity-100');
        } else {
          detail.classList.remove('opacity-100');
          detail.classList.add('opacity-0', 'pointer-events-none');
        }
      });

      // Progress bar: reset then fill over ROTATION_MS
      panel.querySelectorAll('.metric-progress-bar').forEach((bar, i) => {
        bar.style.transition = 'none';
        bar.style.width = '0%';
        if (i === index) {
          void bar.offsetHeight; // force reflow
          bar.style.transition = `width ${ROTATION_MS}ms linear`;
          bar.style.width = '100%';
        }
      });
    }

    function startRotation(tabId) {
      stopRotation(tabId);
      timers[tabId] = setTimeout(() => {
        const next = ((activeIdx[tabId] || 0) + 1) % 3;
        activateMetric(tabId, next);
        startRotation(tabId);
      }, ROTATION_MS);
    }

    function stopRotation(tabId) {
      if (timers[tabId]) {
        clearTimeout(timers[tabId]);
        timers[tabId] = null;
      }
    }

    // Tab switching
    tabButtons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const tabId = btn.getAttribute('data-tab');
        if (tabId === currentTab) return;

        stopRotation(currentTab);

        // Update tab button states
        tabButtons.forEach((b) => {
          b.classList.remove('font-semibold', 'text-[#1A1A1A]', 'border-[#1A1A1A]');
          b.classList.add('font-medium', 'text-[#999999]', 'border-transparent');
        });
        btn.classList.remove('font-medium', 'text-[#999999]', 'border-transparent');
        btn.classList.add('font-semibold', 'text-[#1A1A1A]', 'border-[#1A1A1A]');

        // Show/hide panels
        tabPanels.forEach((p) => {
          if (p.getAttribute('data-panel') === tabId) {
            p.classList.remove('hidden');
          } else {
            p.classList.add('hidden');
          }
        });

        currentTab = tabId;
        activeIdx[tabId] = 0;
        activateMetric(tabId, 0);
        startRotation(tabId);
      });
    });

    // Metric row click — manual override
    document.querySelectorAll('.metric-row').forEach((row) => {
      row.addEventListener('click', (e) => {
        // Don't trigger if chevron link was clicked
        if (e.target.closest('.metric-chevron')) return;

        const panel = row.closest('.tab-panel');
        const tabId = panel.getAttribute('data-panel');
        const idx = parseInt(row.getAttribute('data-metric-idx'));

        stopRotation(tabId);
        activateMetric(tabId, idx);
        startRotation(tabId);
      });
    });

    // Chevron click — prevent row click from firing
    document.querySelectorAll('.metric-chevron').forEach((chevron) => {
      chevron.addEventListener('click', (e) => {
        e.stopPropagation();
      });
    });

    // Boot: activate first metric on first tab
    activateMetric('pmm', 0);
    startRotation('pmm');
  </script>
</Layout>
